<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.lliira.bookworm.core.persist.mapper.AuthorMapper">

	<cache />
	
	<resultMap type="Author" id="AuthorMap">
		<id property="id" column="id" />
		<result property="name" column="name" />
		<result property="description" column="description" />
	</resultMap>

	<insert id="insert" parameterType="Author" useGeneratedKeys="true" keyProperty="id" keyColumn="id">
    <![CDATA[
        INSERT INTO ${core-schema}authors 
        			(name, description)
        VALUES (#{name}, #{description})
    ]]>
	</insert>

	<update id="update" parameterType="Author">
    <![CDATA[
        UPDATE ${core-schema}authors
        SET name = #{name}, description = #{description}
        WHERE id = #{id}
    ]]>
	</update>

	<delete id="delete" parameterType="Author">
    <![CDATA[
        DELETE FROM ${core-schema}authors WHERE id = #{id}
    ]]>
	</delete>

	<select id="select" parameterType="int" resultMap="AuthorMap">
    <![CDATA[
        SELECT * FROM ${core-schema}authors WHERE id = #{id}
    ]]>
	</select>

	<select id="selectByName" parameterType="string" resultMap="AuthorMap">
    <![CDATA[
        SELECT * FROM ${core-schema}authors WHERE name = #{name}
    ]]>
	</select>

	<select id="selectByBook" parameterType="Book" resultMap="AuthorMap">
    <![CDATA[
        SELECT a.* FROM ${core-schema}authors a, ${core-schema}book_authors ba 
        WHERE a.author_id = ba.author_id AND ba.book_id = #{id}
    ]]>
	</select>

</mapper>